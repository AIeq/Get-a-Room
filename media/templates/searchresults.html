{% for room in rooms %}      	
<div class="row">
    <div class="col-md-8 col-md-offset-2">
      <div class="col-md-8">
       
      	<div class="input-group input-group-lg">
	  <span class="input-group-addon"><i class="fa fa-flag"></i> Room {{ room.id }}</span>	  
	  <div class="text-left  span4 collapse-group input-group-addon">
	    <p><a class=" btn" href="#">View details &darr;</a></p>
	    <div class="text-left collapse">
	    <b>{{ room.type }} for </b><br/>
	    {{ room.size }} persons<br/>
	    <b>location:</b> {{ room.location }}<br/>
	    <b>features:</b> <br/>
	    {% for feature in room.features  %}   
	      * {{ feature }}<br/>
	    {% endfor %} 
	    <b>insights:</b> <br/>
	    {% for insight in room.insights  %}   
	      * {{ insight }}<br/>
	    {% endfor %}
	    <b>Free times:</b><br/>
      <table id="{{ room.id }}_reservations" border="1" style="width:220px">
        <tr>  
          <td>m</td> <td>t</td> <td>w</td> <td>t</td> <td>f</td> <td>s</td> <td>s</td> 
        </tr>
        {% for slot in room.reservationData  %} 
        <tr>
          {% for day in slot  %}     
          <td align="center">          
            {% if day %}
            <input type="checkbox" disabled>
            {% else %}   
            <input type="checkbox" name="reserve" value="{{ forloop.counter0 }},{{forloop.parentloop.counter0}}">
            {% endif %}
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </table> 
	    </div>		  
  
	  </div>	 
	  <div class="input-group-addon">
	  <button type="" class="btn btn-default" onclick="reserve('{{ room.id }}')">Reserve</button>
	  </div> 
        
      	</div>
      	  
      </div>
 
    </div> 
     
</div>
           
{% endfor %}
<script type="text/javascript">
  $('.row .btn').on('click', function(e) {
      e.preventDefault();
      var $this = $(this);
      var $collapse = $this.closest('.collapse-group').find('.collapse');
      $collapse.collapse('toggle');
  });
</script>
<script type="text/javascript">
  reserve = function(roomID) {      
      var table = $("#" + roomID + "_reservations")[0]; 
      reservations = "";
      for (var i = 1, row; row = table.rows[i]; i++) {
         for (var j = 0, col; col = row.cells[j]; j++) {
           var cb= $(col).children()[0];
           if (cb.checked) {
             if (reservations != "") reservations = reservations + " ";
             reservations = reservations + cb.value;
           }
         }  
      }
      $("#search-form")[0]["reserve"].value = roomID + ":" + reservations;
      $("#search-form").submit();
  };
</script>
